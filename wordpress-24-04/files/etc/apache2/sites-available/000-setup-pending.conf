# Added to mitigate CVE-2017-8295 vulnerability
UseCanonicalName On

# This configuration serves a setup pending page until WordPress is configured
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        
        DocumentRoot /var/www
        
        # Only serve the setup-pending.html file
        <Directory /var/www/>
            Options -Indexes
            AllowOverride None
            Require all granted
            
            # Rewrite everything to setup-pending.html
            RewriteEngine On
            RewriteCond %{REQUEST_URI} !^/setup-pending\.html$
            RewriteRule ^.*$ /setup-pending.html [L]
        </Directory>
        
        # Deny access to everything except setup-pending.html
        <FilesMatch "^(?!setup-pending\.html$).*">
            Require all denied
        </FilesMatch>

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
